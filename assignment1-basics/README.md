# Assignment 1 — Basics (tokenizer + transformer)

This repository contains the code and tests for the "assignment1-basics" project (byte-level BPE tokenizer, Transformer building blocks, training utilities, and small example scripts).

This project uses the `uv` developer tooling for reproducible environments and to run commands against the locked dependency set in `uv.lock`.

Quick start (recommended — using `uv`)

1. Install the `uv` CLI (system-wide or in a small virtualenv):

```bash
python -m pip install --upgrade uv
```

2. Create and populate a managed Python environment from the lockfile (this uses `pyproject.toml` + `uv.lock`):

```bash
# create/activate a managed environment and install dependencies
uv install

# run tests inside the managed environment
uv run pytest -q
```

3. Run scripts inside the managed environment (example):

```bash
# run the training script using the managed environment
uv run python scripts/train.py --help

# run encoding script (example)
uv run python scripts/encode_and_memmap.py --help
```

Why use `uv` here?
- `uv` provides a reproducible environment by honoring `pyproject.toml` and `uv.lock` (the lockfile). Use `uv install` to create an environment that matches the locked versions exactly.
- Use `uv run <cmd>` to execute commands (pytest, python scripts) inside that environment so developers and CI run the same software stack.

Notes about `uv.lock` and `pyproject.toml`
- `pyproject.toml` describes the project metadata and (optionally) tool configuration. This repository keeps implementation and test configuration there.
- `uv.lock` is a lockfile generated by `uv` (or the tooling used to create the environment). Do not edit `uv.lock` manually — regenerate it only via the tooling that created it.

If you prefer not to use `uv`, you can still create a Python virtualenv manually and install the minimal runtime/test dependencies with pip, for example:

```bash
python -m venv .venv
source .venv/bin/activate
python -m pip install -U pip
python -m pip install pytest numpy torch regex pypdf
pytest -q
```

Project layout
- `cs336_basics/impl/` — canonical implementations and small adapters exported via `cs336_basics.impl`.
- `cs336_basics/` — model and layer modules (Transformer, layers, RoPE, etc.).
- `scripts/` — convenience scripts for training, encoding, and evaluation.
- `tests/` — unit tests that exercise the required functionality.
- `data/` — small sample datasets (a few small files are stored in the repo; large datasets should be kept outside the repo and referenced in `.gitignore`).
- `uv.lock` — lockfile for the `uv` environment. Do not edit manually.

If you'd like, I can add a `dev-requirements.txt` (for folks who prefer pip) or a short `CONTRIBUTING.md` that documents `uv` usage in more detail.
